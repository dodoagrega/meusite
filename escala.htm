<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escala Corrigida Final</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f0f0f0; }
        .card { background: #fff; padding: 15px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .op { display: inline-block; padding: 5px 10px; border-radius: 5px; color: #fff; margin-left: 10px; }
        .Front { background-color: #4caf50; }
        .Back { background-color: #2196f3; }
        .Portas { background-color: #ff9800; }
    </style>
</head>
<body>

<h1>Escala Corrigida Final</h1>
<div id="escala"></div>

<script>
// Dados iniciais
const equipes = {
    "Equipe 1": ["Willians", "L. Ferreira", "Fernando"],
    "Equipe 2": ["Sérgio", "Tiago", "Cal"],
    "Equipe 3": ["Dodo", "Elizeu", "Hércules"],
    "Equipe 4": ["Glauco", "Rodrigão"],
    "Equipe 5": ["Felipe", "Marcus V."]
};

const mortoInicial = ["Elizeu", "Dodo", "Rodrigão", "Cal", "Fernando"];
const operacoes = ["Front", "Back", "Portas"];
const rodizioCarros = [
    ["Equipe 1", "Equipe 2", "Equipe 3"],
    ["Equipe 2", "Equipe 3", "Equipe 1"],
    ["Equipe 3", "Equipe 1", "Equipe 2"],
    ["Equipe 1", "Equipe 2", "Equipe 3"],
    ["Equipe 2", "Equipe 3", "Equipe 1"]
];

// Operações iniciais de cada trabalhador (segunda-feira)
let operacoesIniciais = {
    "Willians": 0, "L. Ferreira": 1, "Fernando": 2,
    "Sérgio": 1, "Tiago": 2, "Cal": 0,
    "Dodo": 2, "Elizeu": 0, "Hércules": 1,
    "Glauco": 0, "Rodrigão": 1,
    "Felipe": 0, "Marcus V.": 1
};

// Ciclo de operações dos carros 4 e 5
let ciclosFixos = {"Glauco": 0, "Rodrigão": 1, "Felipe": 0, "Marcus V.": 1};
let ciclos = {...operacoesIniciais};

let escalaDiv = document.getElementById("escala");
let refinoHoje = mortoInicial[0];

for (let dia = 0; dia < 5; dia++) {
    let card = document.createElement("div");
    card.className = "card";
    let diaNome = ["Segunda", "Terça", "Quarta", "Quinta", "Sexta"][dia];
    card.innerHTML = `<h3>${diaNome}</h3>`;

    // Clonar equipes para evitar modificação no original
    let equipesDia = JSON.parse(JSON.stringify(equipes));

    // Encontrar a equipe do refino
    let equipeDoRefino = Object.keys(equipesDia).find(equipe =>
        equipesDia[equipe].includes(refinoHoje)
    );

    // Retirar o operador do refino da equipe dele (para ele não aparecer no carro e no morto)
    if (equipeDoRefino) {
        equipesDia[equipeDoRefino] = equipesDia[equipeDoRefino].filter(p => p !== refinoHoje);
    }

    // Carros 1, 2, 3 com rodízio e ciclo de operações
    for (let carro = 0; carro < 3; carro++) {
        let equipe = rodizioCarros[dia][carro];
        let pessoas = equipesDia[equipe];
        let carroHTML = `<strong>Carro ${carro + 1}:</strong><br>`;
        pessoas.forEach(pessoa => {
            let op = operacoes[ciclos[pessoa] % 3];
            carroHTML += `- ${pessoa}: <span class="op ${op}">${op}</span><br>`;
            ciclos[pessoa] = (ciclos[pessoa] + 8) % 3;
        });
        card.innerHTML += carroHTML;
    }

    // Carros 4 e 5 fixos
    for (let idx = 4; idx <= 5; idx++) {
        let dupla = equipesDia[`Equipe ${idx}`];
        let carroHTML = `<strong>Carro ${idx}:</strong><br>`;
        dupla.forEach(pessoa => {
            let op = operacoes[ciclosFixos[pessoa] % 2 * 2];
            carroHTML += `- ${pessoa}: <span class="op ${op}">${op}</span><br>`;
            ciclosFixos[pessoa] = (ciclosFixos[pessoa] + 8) % 2;
        });
        card.innerHTML += carroHTML;
    }

    // Morto/Refino do dia
    card.innerHTML += `<br><strong>Morto/Refino:</strong> ${refinoHoje}`;

    // Avançar refino para o próximo dia
    if (dia < 4) {
        let idxRefino = mortoInicial.indexOf(refinoHoje);
        refinoHoje = mortoInicial[(idxRefino + 1) % mortoInicial.length];
    }

    escalaDiv.appendChild(card);
}
</script>
</body>
</html>