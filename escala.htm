<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Escala Completa com Substituição Correta</title>
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 10px; background-color: #f0f0f0; }
  h1 { text-align: center; color: #333; }
  .card { background-color: #fff; margin: 10px auto; padding: 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); max-width: 400px; }
  .card h2 { margin-top: 0; color: #007bff; }
  .carro, .refino { margin-bottom: 8px; }
  .op { display: inline-block; padding: 2px 6px; border-radius: 4px; margin-right: 4px; }
  .Front { background-color: #4caf50; color: white; }
  .Back { background-color: #2196f3; color: white; }
  .Portas { background-color: #ff9800; color: white; }
</style>
</head>
<body>

<h1>Escala Completa Corrigida</h1>
<div id="escala"></div>

<script>
// Configurações
const dias = ["Segunda", "Terça", "Quarta", "Quinta", "Sexta"];
const operacoes = ["Front", "Back", "Portas"];
const equipesBase = {
  "Equipe 1": ["Willians", "L. Ferreira", "Fernando"],
  "Equipe 2": ["Sérgio", "Tiago", "Cal"],
  "Equipe 3": ["Dodo", "Elizeu", "Hércules"],
  "Equipe 4": ["Glauco", "Rodrigão"],
  "Equipe 5": ["Felipe", "Marcus V."]
};
const rodizioCarros = [
  ["Equipe 1", "Equipe 2", "Equipe 3"],
  ["Equipe 2", "Equipe 3", "Equipe 1"],
  ["Equipe 3", "Equipe 1", "Equipe 2"],
  ["Equipe 1", "Equipe 2", "Equipe 3"],
  ["Equipe 2", "Equipe 3", "Equipe 1"]
];
// Inicial escala do Morto/Refino
const mortoInicial = ["Elizeu", "Dodo", "Rodrigão", "Cal", "Fernando"];

const escalaDiv = document.getElementById("escala");

// Ciclo de operações para cada trabalhador (início: 0 - Front)
let ciclos = {};
for (const [equipe, membros] of Object.entries(equipesBase)) {
  for (const nome of membros) {
    ciclos[nome] = 0;
  }
}
// Ciclo para equipes fixas (4 e 5)
let ciclosFixos = {
  "Glauco": 0, "Rodrigão": 1,
  "Felipe": 0, "Marcus V.": 1
};

// Variável para controlar o refino do dia e a substituição
let refinoHoje = mortoInicial[0];

for (let d = 0; d < dias.length; d++) {
  const card = document.createElement("div");
  card.className = "card";

  const titulo = document.createElement("h2");
  titulo.textContent = dias[d];
  card.appendChild(titulo);

  // Preparar equipes para o dia, removendo o escalado para o refino
  const equipesDia = JSON.parse(JSON.stringify(equipesBase));  // Cópia
  for (const equipe of ["Equipe 1", "Equipe 2", "Equipe 3"]) {
    equipesDia[equipe] = equipesDia[equipe].filter(n => n !== refinoHoje);
  }

  // Distribuir Carros 1-3
  for (let c = 0; c < 3; c++) {
    const equipeNome = rodizioCarros[d][c];
    const membros = equipesDia[equipeNome];
    let detalhe = `<strong>Carro ${c+1}:</strong><br>`;
    membros.forEach(membro => {
      let op = operacoes[ciclos[membro] % 3];
      detalhe += `- ${membro}: <span class="op ${op}">${op}</span><br>`;
      ciclos[membro] = (ciclos[membro] + 8) % 3;  // Avança 8h para o próximo dia
    });
    const div = document.createElement("div");
    div.className = "carro";
    div.innerHTML = detalhe;
    card.appendChild(div);
  }

  // Carros 4 e 5 fixos
  ["Carro 4", "Carro 5"].forEach((carro, idx) => {
    const dupla = idx === 0 ? ["Glauco", "Rodrigão"] : ["Felipe", "Marcus V."];
    let detalhe = `<strong>${carro}:</strong><br>`;
    dupla.forEach(membro => {
      const op = operacoes[ciclosFixos[membro] % 2 * 2];  // Front ou Portas
      detalhe += `- ${membro}: <span class="op ${op}">${op}</span><br>`;
      ciclosFixos[membro] = (ciclosFixos[membro] + 8) % 2;
    });
    const div = document.createElement("div");
    div.className = "carro";
    div.innerHTML = detalhe;
    card.appendChild(div);
  });

  // Mostrar refino do dia
  const refinoDiv = document.createElement("div");
  refinoDiv.className = "refino";
  refinoDiv.innerHTML = `<strong>Morto/Refino:</strong> ${refinoHoje}`;
  card.appendChild(refinoDiv);

  // Atualizar para o dia seguinte (substituição)
  if (d < dias.length - 1) {
    const idxHoje = mortoInicial.indexOf(refinoHoje);
    refinoHoje = mortoInicial[(idxHoje + 1) % mortoInicial.length];
  }

  escalaDiv.appendChild(card);
}
</script>

</body>
</html>